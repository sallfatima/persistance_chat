# ğŸ—ï¸ ARCHITECTURE DES 3 SOLUTIONS CHATBOT

## ğŸ“‹ TABLE DES MATIÃˆRES

1. [Solution 3 MVP - Architecture Simple](#solution-3-mvp)
2. [Solution 1 Redis - Architecture Cache](#solution-1-redis)
3. [Solution 2 Temporal - Architecture Workflows](#solution-2-temporal)
4. [Comparaison Architecture](#comparaison)

---

## ğŸŸ¢ SOLUTION 3 MVP - Architecture Simple

### Vue d'ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER BROWSER                          â”‚
â”‚                     http://localhost:8501                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTP REST + Polling
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CHAINLIT FRONTEND                          â”‚
â”‚                    (Container: Port 8501)                    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Chainlit App (app.py)                             â”‚    â”‚
â”‚  â”‚  â€¢ @cl.on_chat_start                               â”‚    â”‚
â”‚  â”‚  â€¢ @cl.on_message                                  â”‚    â”‚
â”‚  â”‚  â€¢ @cl.on_settings_update                          â”‚    â”‚
â”‚  â”‚  â€¢ Backend health check                            â”‚    â”‚
â”‚  â”‚  â€¢ Polling loop (0.2s)                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTP REST API
                             â”‚ â€¢ POST /api/chat/generate
                             â”‚ â€¢ GET /api/chat/status/{id}
                             â”‚ â€¢ GET /api/chat/chunks/{id}
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FASTAPI BACKEND                            â”‚
â”‚                    (Container: Port 8000)                    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  FastAPI App (backend.py)                          â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  Endpoints                                â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET /                                  â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET /health                            â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POST /api/chat/generate                â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET /api/chat/status/{task_id}        â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GET /api/chat/chunks/{task_id}        â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  Streaming Functions                      â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ stream_openai()                        â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ stream_anthropic()                     â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  SimpleStorage Class                      â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ save_task_state()                      â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ get_task_state()                       â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ save_chunk()          â­ PERSISTANCE  â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ get_chunks()          â­ RÃ‰CUPÃ‰RATION â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                â”‚
                 â”‚                â”‚ API Calls
                 â”‚                â–¼
                 â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚    â”‚   OpenAI API         â”‚
                 â”‚    â”‚   gpt-4o, gpt-4      â”‚
                 â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                â”‚
                 â”‚                â–¼
                 â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚    â”‚  Anthropic API       â”‚
                 â”‚    â”‚  claude-3.5-sonnet   â”‚
                 â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ File I/O
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  LOCAL FILE SYSTEM                           â”‚
â”‚                 (Docker Volume: backend-storage)             â”‚
â”‚                                                              â”‚
â”‚  /storage/                                                   â”‚
â”‚  â”œâ”€â”€ {task_id}_state.json        â­ Ã‰tat tÃ¢che             â”‚
â”‚  â”œâ”€â”€ {task_id}_chunks.json       â­ Tous les chunks        â”‚
â”‚  â””â”€â”€ {task_id}_metadata.json                                â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Flux de DonnÃ©es DÃ©taillÃ©

#### 1ï¸âƒ£ CrÃ©ation de TÃ¢che

```
User Browser
    â”‚
    â”‚ 1. User tape message "Hello AI"
    â–¼
Chainlit Frontend
    â”‚
    â”‚ 2. POST /api/chat/generate
    â”‚    Body: {
    â”‚      "prompt": "Hello AI",
    â”‚      "provider": "openai",
    â”‚      "model": "gpt-4o",
    â”‚      "temperature": 0.7
    â”‚    }
    â–¼
FastAPI Backend
    â”‚
    â”‚ 3. GÃ©nÃ¨re task_id = "abc-123"
    â”‚ 4. Save state: /storage/abc-123_state.json
    â”‚    {
    â”‚      "task_id": "abc-123",
    â”‚      "status": "running",
    â”‚      "prompt": "Hello AI",
    â”‚      ...
    â”‚    }
    â”‚
    â”‚ 5. Lance asyncio.create_task(stream_openai(...))
    â”‚
    â”‚ 6. Return: {"task_id": "abc-123", "status": "running"}
    â–¼
Chainlit Frontend
    â”‚
    â”‚ 7. DÃ©marre polling loop
    â””â”€â–º (voir flux streaming)
```

#### 2ï¸âƒ£ Streaming en Cours

```
OpenAI API
    â”‚
    â”‚ Stream: "Hello" â†’ " there" â†’ "!" â†’ ...
    â–¼
FastAPI Backend (stream_openai)
    â”‚
    â”‚ Pour chaque chunk:
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â”‚ 1. Chunk arrive: "Hello"              â”‚
    â”‚ â”‚ 2. storage.save_chunk(                â”‚
    â”‚ â”‚      task_id="abc-123",               â”‚
    â”‚ â”‚      chunk_id=0,                      â”‚
    â”‚ â”‚      text="Hello"                     â”‚
    â”‚ â”‚    )                                  â”‚
    â”‚ â”‚                                       â”‚
    â”‚ â”‚ 3. Ã‰crit: /storage/abc-123_chunks.jsonâ”‚
    â”‚ â”‚    [                                  â”‚
    â”‚ â”‚      {                                â”‚
    â”‚ â”‚        "chunk_id": 0,                 â”‚
    â”‚ â”‚        "text": "Hello",               â”‚
    â”‚ â”‚        "timestamp": "2025-12-03..."   â”‚
    â”‚ â”‚      }                                â”‚
    â”‚ â”‚    ]                    â­ PERSISTANCEâ”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
(continue pour chunk 1, 2, 3...)
```

#### 3ï¸âƒ£ Polling par Frontend

```
Chainlit Frontend (boucle while)
    â”‚
    â”‚ GET /api/chat/chunks/abc-123?from_id=0
    â–¼
FastAPI Backend
    â”‚
    â”‚ storage.get_chunks("abc-123", from_id=0)
    â”‚
    â”‚ Lit: /storage/abc-123_chunks.json
    â”‚ Retourne: [chunk0, chunk1, chunk2]
    â–¼
Chainlit Frontend
    â”‚
    â”‚ Pour chaque chunk:
    â”‚   await msg.stream_token(chunk["text"])
    â”‚
    â”‚ Affiche: "Hello there!"
    â”‚
    â”‚ Wait 0.2s
    â”‚ from_id = 3
    â”‚
    â”‚ GET /api/chat/chunks/abc-123?from_id=3
    â”‚ ...
    â””â”€â–º (rÃ©pÃ¨te jusqu'Ã  status="completed")
```

#### 4ï¸âƒ£ RafraÃ®chissement Page (F5)

```
User Browser
    â”‚
    â”‚ User appuie F5 pendant gÃ©nÃ©ration
    â–¼
Chainlit Frontend
    â”‚
    â”‚ âŒ Perd Ã©tat local
    â”‚ âŒ Perd task_id courant
    â”‚ âŒ Perd message en cours
    â”‚
    â”‚ ğŸ”„ Rechargement page
    â”‚
    â”‚ âš ï¸ PROBLÃˆME: Comment rÃ©cupÃ©rer la gÃ©nÃ©ration en cours ?
    â”‚
    â”‚ SOLUTION MVP:
    â”‚ User doit re-demander avec MÃŠME prompt
    â”‚ â†’ Backend check cache (mais pas implÃ©mentÃ© dans MVP)
    â”‚
    â””â”€â–º User re-tape message
```

**âš ï¸ LIMITATION MVP: Pas de vraie reconnexion aprÃ¨s F5**

---

## ğŸ”´ SOLUTION 1 REDIS - Architecture avec Cache

### Vue d'ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER BROWSER                          â”‚
â”‚                     http://localhost:8501                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTP REST + Polling
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CHAINLIT FRONTEND                          â”‚
â”‚                    (Container: Port 8501)                    â”‚
â”‚                                                              â”‚
â”‚  â€¢ Cache status display                                      â”‚
â”‚  â€¢ Stats display (cache hit rate)                           â”‚
â”‚  â€¢ Badge ğŸ¯ CACHE HIT                                       â”‚
â”‚  â€¢ Badge ğŸ†• NOUVELLE GÃ‰NÃ‰RATION                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTP REST API
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FASTAPI BACKEND                            â”‚
â”‚                    (Container: Port 8000)                    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  FastAPI App (backend.py)                          â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Endpoints + Cache Logic                           â”‚    â”‚
â”‚  â”‚  â€¢ POST /api/chat/generate                         â”‚    â”‚
â”‚  â”‚       â†“                                             â”‚    â”‚
â”‚  â”‚       1. Generate cache_key                        â”‚    â”‚
â”‚  â”‚       2. Check Redis                               â”‚    â”‚
â”‚  â”‚       3. IF HIT â†’ Return instant                   â”‚    â”‚
â”‚  â”‚       4. IF MISS â†’ Generate + Save to cache        â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  â€¢ GET /api/stats                                  â”‚    â”‚
â”‚  â”‚       â†’ Cache hit rate, total tasks, etc.          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚         â”‚         â”‚                â”‚
       â”‚         â”‚         â”‚                â”‚ API Calls
       â”‚         â”‚         â”‚                â–¼
       â”‚         â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         â”‚         â”‚    â”‚   OpenAI API         â”‚
       â”‚         â”‚         â”‚    â”‚   â€¢ gpt-4o           â”‚
       â”‚         â”‚         â”‚    â”‚   â€¢ gpt-4            â”‚
       â”‚         â”‚         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚         â”‚         â”‚                â”‚
       â”‚         â”‚         â”‚                â–¼
       â”‚         â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         â”‚         â”‚    â”‚  Anthropic API       â”‚
       â”‚         â”‚         â”‚    â”‚  â€¢ claude-3.5-sonnet â”‚
       â”‚         â”‚         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚         â”‚         â”‚
       â”‚         â”‚         â”‚
       â”‚         â”‚         â–¼
       â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         â”‚    â”‚         REDIS                       â”‚
       â”‚         â”‚    â”‚    (Container: Port 6379)           â”‚
       â”‚         â”‚    â”‚                                     â”‚
       â”‚         â”‚    â”‚  Key-Value Store (In-Memory)       â”‚
       â”‚         â”‚    â”‚                                     â”‚
       â”‚         â”‚    â”‚  â­ CACHE LAYER                    â”‚
       â”‚         â”‚    â”‚                                     â”‚
       â”‚         â”‚    â”‚  chat:cache:{sha256_hash}          â”‚
       â”‚         â”‚    â”‚  â”œâ”€â”€ value: {                      â”‚
       â”‚         â”‚    â”‚  â”‚     "full_response": "...",     â”‚
       â”‚         â”‚    â”‚  â”‚     "provider": "openai",       â”‚
       â”‚         â”‚    â”‚  â”‚     "model": "gpt-4o",          â”‚
       â”‚         â”‚    â”‚  â”‚     "timestamp": "..."          â”‚
       â”‚         â”‚    â”‚  â”‚   }                             â”‚
       â”‚         â”‚    â”‚  â””â”€â”€ TTL: 3600 seconds (1 hour)    â”‚
       â”‚         â”‚    â”‚                                     â”‚
       â”‚         â”‚    â”‚  Persistence: appendonly.aof       â”‚
       â”‚         â”‚    â”‚  (Docker volume: redis-data)       â”‚
       â”‚         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚         â”‚
       â”‚         â”‚
       â”‚         â”‚ SQL Queries
       â”‚         â–¼
       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚          POSTGRESQL                         â”‚
       â”‚    â”‚     (Container: Port 5432)                  â”‚
       â”‚    â”‚                                             â”‚
       â”‚    â”‚  â­ DURABLE STORAGE                         â”‚
       â”‚    â”‚                                             â”‚
       â”‚    â”‚  Table: chat_tasks                          â”‚
       â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
       â”‚    â”‚  â”‚ id (PK)  â”‚ prompt   â”‚ status  â”‚ cached â”‚â”‚
       â”‚    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
       â”‚    â”‚  â”‚ abc-123  â”‚ "Hello"  â”‚ completeâ”‚   0    â”‚â”‚
       â”‚    â”‚  â”‚ def-456  â”‚ "Hello"  â”‚ completeâ”‚   1    â”‚â”‚ â† Cache hit
       â”‚    â”‚  â”‚ ghi-789  â”‚ "AI?"    â”‚ running â”‚   0    â”‚â”‚
       â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
       â”‚    â”‚                                             â”‚
       â”‚    â”‚  Table: chat_chunks                         â”‚
       â”‚    â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
       â”‚    â”‚  â”‚ id â”‚ task_id â”‚ chunk_id â”‚ text         â”‚â”‚
       â”‚    â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
       â”‚    â”‚  â”‚  1 â”‚ abc-123 â”‚    0     â”‚ "Hello"      â”‚â”‚
       â”‚    â”‚  â”‚  2 â”‚ abc-123 â”‚    1     â”‚ " there"     â”‚â”‚
       â”‚    â”‚  â”‚  3 â”‚ abc-123 â”‚    2     â”‚ "!"          â”‚â”‚
       â”‚    â”‚  â”‚  4 â”‚ def-456 â”‚    0     â”‚ "Hello"      â”‚â”‚ â† From cache
       â”‚    â”‚  â”‚  5 â”‚ def-456 â”‚    1     â”‚ " there"     â”‚â”‚
       â”‚    â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
       â”‚    â”‚                                             â”‚
       â”‚    â”‚  Persistence: postgres-data volume         â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â–º Docker Network: chatbot-network
```

### Flux de DonnÃ©es - Cache Hit

```
User: "Explain AI"
    â”‚
    â–¼
POST /api/chat/generate
    â”‚
    â”‚ 1. Generate cache_key
    â”‚    prompt = "Explain AI"
    â”‚    provider = "openai"
    â”‚    model = "gpt-4o"
    â”‚    
    â”‚    cache_key = sha256("Explain AI:openai:gpt-4o")
    â”‚              = "chat:cache:7a3f2b..."
    â”‚
    â–¼
Redis Check
    â”‚
    â”‚ 2. await redis_client.get("chat:cache:7a3f2b...")
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¯ CACHE HIT !                                            â”‚
â”‚                                                           â”‚
â”‚ Cached data found:                                        â”‚
â”‚ {                                                         â”‚
â”‚   "full_response": "AI is artificial intelligence...",    â”‚
â”‚   "provider": "openai",                                   â”‚
â”‚   "model": "gpt-4o",                                      â”‚
â”‚   "timestamp": "2025-12-03T10:00:00"                      â”‚
â”‚ }                                                         â”‚
â”‚                                                           â”‚
â”‚ 3. Create new task_id = "def-456"                        â”‚
â”‚                                                           â”‚
â”‚ 4. Save to PostgreSQL:                                   â”‚
â”‚    INSERT INTO chat_tasks VALUES (                        â”‚
â”‚      "def-456",                                           â”‚
â”‚      "Explain AI",                                        â”‚
â”‚      "completed",                                         â”‚
â”‚      1  â† â­ cached = 1                                  â”‚
â”‚    )                                                      â”‚
â”‚                                                           â”‚
â”‚ 5. Split full_response into chunks (50 chars each)       â”‚
â”‚                                                           â”‚
â”‚ 6. Save chunks to PostgreSQL:                            â”‚
â”‚    INSERT INTO chat_chunks VALUES (                       â”‚
â”‚      4, "def-456", 0, "AI is artificial intelligence..."  â”‚
â”‚    )                                                      â”‚
â”‚    INSERT INTO chat_chunks VALUES (                       â”‚
â”‚      5, "def-456", 1, " It involves machine learning..."  â”‚
â”‚    )                                                      â”‚
â”‚    ...                                                    â”‚
â”‚                                                           â”‚
â”‚ 7. Return immediately:                                   â”‚
â”‚    {                                                      â”‚
â”‚      "task_id": "def-456",                                â”‚
â”‚      "status": "completed",                               â”‚
â”‚      "cached": true  â† â­ Frontend shows ğŸ¯ badge        â”‚
â”‚    }                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ â±ï¸ Total time: 0.5 seconds !
    â”‚ ğŸ’° Cost saved: $0.02 (no LLM call)
    â–¼
Frontend displays instantly with ğŸ¯ CACHE HIT badge
```

### Flux de DonnÃ©es - Cache Miss

```
User: "Explain quantum computing"
    â”‚
    â–¼
POST /api/chat/generate
    â”‚
    â”‚ 1. cache_key = sha256("Explain quantum computing:openai:gpt-4o")
    â”‚              = "chat:cache:9f4e8c..."
    â–¼
Redis Check
    â”‚
    â”‚ 2. await redis_client.get("chat:cache:9f4e8c...")
    â”‚    â†’ None
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ CACHE MISS                                             â”‚
â”‚                                                           â”‚
â”‚ 3. Create task_id = "ghi-789"                            â”‚
â”‚                                                           â”‚
â”‚ 4. Save to PostgreSQL:                                   â”‚
â”‚    INSERT INTO chat_tasks VALUES (                        â”‚
â”‚      "ghi-789",                                           â”‚
â”‚      "Explain quantum computing",                         â”‚
â”‚      "running",                                           â”‚
â”‚      0  â† â­ cached = 0                                  â”‚
â”‚    )                                                      â”‚
â”‚                                                           â”‚
â”‚ 5. Launch async task:                                    â”‚
â”‚    asyncio.create_task(                                  â”‚
â”‚      generate_with_cache_save(                           â”‚
â”‚        task_id="ghi-789",                                â”‚
â”‚        prompt="Explain quantum computing",               â”‚
â”‚        cache_key="chat:cache:9f4e8c..."                 â”‚
â”‚      )                                                    â”‚
â”‚    )                                                      â”‚
â”‚                                                           â”‚
â”‚ 6. Return immediately:                                   â”‚
â”‚    {                                                      â”‚
â”‚      "task_id": "ghi-789",                                â”‚
â”‚      "status": "running",                                 â”‚
â”‚      "cached": false  â† â­ Frontend shows ğŸ†• badge       â”‚
â”‚    }                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
Async Generation (in background)
    â”‚
    â”‚ 7. Stream from OpenAI API
    â”‚    "Quantum" â†’ " computing" â†’ " uses" â†’ ...
    â”‚
    â”‚ 8. For each chunk:
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    â”‚ â€¢ Save to PostgreSQL                 â”‚
    â”‚    â”‚   INSERT INTO chat_chunks VALUES (   â”‚
    â”‚    â”‚     ..., "ghi-789", 0, "Quantum"     â”‚
    â”‚    â”‚   )                                  â”‚
    â”‚    â”‚                                      â”‚
    â”‚    â”‚ â€¢ Accumulate: full_response += chunk â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ 9. After completion:
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    â”‚ â­ SAVE TO REDIS CACHE              â”‚
    â”‚    â”‚                                      â”‚
    â”‚    â”‚ await redis_client.setex(            â”‚
    â”‚    â”‚   "chat:cache:9f4e8c...",           â”‚
    â”‚    â”‚   3600,  # TTL = 1 hour             â”‚
    â”‚    â”‚   json.dumps({                       â”‚
    â”‚    â”‚     "full_response": full_response,  â”‚
    â”‚    â”‚     "provider": "openai",            â”‚
    â”‚    â”‚     "model": "gpt-4o",               â”‚
    â”‚    â”‚     "timestamp": "..."               â”‚
    â”‚    â”‚   })                                 â”‚
    â”‚    â”‚ )                                    â”‚
    â”‚    â”‚                                      â”‚
    â”‚    â”‚ Update PostgreSQL:                   â”‚
    â”‚    â”‚ UPDATE chat_tasks                    â”‚
    â”‚    â”‚ SET status = "completed"             â”‚
    â”‚    â”‚ WHERE id = "ghi-789"                 â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ â±ï¸ Total time: 8 seconds
    â”‚ ğŸ’° Cost: $0.02 (LLM call)
    â–¼
Next time same prompt â†’ ğŸ¯ CACHE HIT (0.5s, $0 cost)
```

### Flux aprÃ¨s F5 (avec PostgreSQL)

```
User appuie F5 pendant gÃ©nÃ©ration "ghi-789"
    â”‚
    â–¼
Frontend recharge
    â”‚
    â”‚ âŒ Perd task_id "ghi-789" en mÃ©moire
    â”‚
    â”‚ âš ï¸ PROBLÃˆME: Comment rÃ©cupÃ©rer ?
    â”‚
    â”‚ SOLUTIONS POSSIBLES:
    â”‚
    â”‚ Option A: URL avec task_id
    â”‚ http://localhost:8501?task_id=ghi-789
    â”‚
    â”‚ Option B: Cookie/LocalStorage
    â”‚ localStorage.setItem("current_task", "ghi-789")
    â”‚
    â”‚ Option C: User re-demande
    â”‚ User tape Ã  nouveau â†’ Backend check si dÃ©jÃ  exists
    â”‚
    â””â”€â–º (implÃ©mentation requise dans frontend)

SI on a le task_id:
    â”‚
    â”‚ GET /api/chat/chunks/ghi-789
    â–¼
PostgreSQL Query
    â”‚
    â”‚ SELECT * FROM chat_chunks
    â”‚ WHERE task_id = 'ghi-789'
    â”‚ ORDER BY chunk_id
    â–¼
Return all chunks so far
    â”‚
    â”‚ Chunks 0-50 already generated
    â”‚
    â–¼
Frontend displays + continues polling
```

**âœ… AVANTAGE vs MVP: Chunks en PostgreSQL persistent mÃªme si backend crash**

---

## ğŸŸ£ SOLUTION 2 TEMPORAL - Architecture Workflows

### Vue d'ensemble ComplÃ¨te

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              USER BROWSER                                     â”‚
â”‚                           http://localhost:8501                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTP REST
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CHAINLIT FRONTEND                                    â”‚
â”‚                         (Container: Port 8501)                                â”‚
â”‚                                                                               â”‚
â”‚  â€¢ Workflow status monitoring                                                â”‚
â”‚  â€¢ Progress bar (0-100%)                                                     â”‚
â”‚  â€¢ Timeline display                                                          â”‚
â”‚  â€¢ Link to Temporal UI                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTP REST API
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          FASTAPI BACKEND                                      â”‚
â”‚                         (Container: Port 8000)                                â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  FastAPI App (backend.py)                                            â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  â­ TEMPORAL CLIENT                                                  â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  Endpoints:                                                          â”‚    â”‚
â”‚  â”‚  â€¢ POST /api/workflows/start                                         â”‚    â”‚
â”‚  â”‚      â†’ client.start_workflow()                                       â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  â€¢ GET /api/workflows/{id}/status                                    â”‚    â”‚
â”‚  â”‚      â†’ handle.query(get_status)                                      â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  â€¢ GET /api/workflows/{id}/chunks                                    â”‚    â”‚
â”‚  â”‚      â†’ handle.query(get_chunks)                                      â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  â€¢ POST /api/workflows/{id}/cancel                                   â”‚    â”‚
â”‚  â”‚      â†’ handle.signal(cancel)                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ gRPC (Port 7233)
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          TEMPORAL SERVER                                      â”‚
â”‚                         (Container: Port 7233)                                â”‚
â”‚                                                                               â”‚
â”‚  â­ ORCHESTRATION ENGINE                                                     â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Core Components:                                                   â”‚     â”‚
â”‚  â”‚                                                                      â”‚     â”‚
â”‚  â”‚  1. Frontend Service                                                â”‚     â”‚
â”‚  â”‚     â€¢ Receives workflow start requests                              â”‚     â”‚
â”‚  â”‚     â€¢ Handles queries and signals                                   â”‚     â”‚
â”‚  â”‚                                                                      â”‚     â”‚
â”‚  â”‚  2. History Service                                                 â”‚     â”‚
â”‚  â”‚     â€¢ Stores workflow events                                        â”‚     â”‚
â”‚  â”‚     â€¢ Event sourcing                                                â”‚     â”‚
â”‚  â”‚     â€¢ Checkpointing                                                 â”‚     â”‚
â”‚  â”‚                                                                      â”‚     â”‚
â”‚  â”‚  3. Matching Service                                                â”‚     â”‚
â”‚  â”‚     â€¢ Task queue management                                         â”‚     â”‚
â”‚  â”‚     â€¢ Distributes tasks to workers                                  â”‚     â”‚
â”‚  â”‚                                                                      â”‚     â”‚
â”‚  â”‚  4. Worker Service                                                  â”‚     â”‚
â”‚  â”‚     â€¢ Monitors worker health                                        â”‚     â”‚
â”‚  â”‚     â€¢ Handles worker failures                                       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
           â”‚                â”‚                   â”‚                            â”‚
           â”‚                â”‚                   â”‚                            â”‚
           â”‚                â”‚                   â”‚                            â”‚
           â”‚                â”‚                   â”‚ SQL Queries                â”‚
           â”‚                â”‚                   â–¼                            â”‚
           â”‚                â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
           â”‚                â”‚    â”‚       POSTGRESQL                      â”‚   â”‚
           â”‚                â”‚    â”‚  (Container: Port 5432)               â”‚   â”‚
           â”‚                â”‚    â”‚                                       â”‚   â”‚
           â”‚                â”‚    â”‚  â­ TEMPORAL EVENT STORE             â”‚   â”‚
           â”‚                â”‚    â”‚                                       â”‚   â”‚
           â”‚                â”‚    â”‚  Tables:                              â”‚   â”‚
           â”‚                â”‚    â”‚  â€¢ executions                         â”‚   â”‚
           â”‚                â”‚    â”‚  â€¢ activities                         â”‚   â”‚
           â”‚                â”‚    â”‚  â€¢ history_events                     â”‚   â”‚
           â”‚                â”‚    â”‚  â€¢ namespace_metadata                 â”‚   â”‚
           â”‚                â”‚    â”‚                                       â”‚   â”‚
           â”‚                â”‚    â”‚  Example: history_events              â”‚   â”‚
           â”‚                â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
           â”‚                â”‚    â”‚  â”‚ id   â”‚ workflowâ”‚ event_type   â”‚   â”‚   â”‚
           â”‚                â”‚    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
           â”‚                â”‚    â”‚  â”‚ 1    â”‚ chat-1  â”‚ STARTED      â”‚   â”‚   â”‚
           â”‚                â”‚    â”‚  â”‚ 2    â”‚ chat-1  â”‚ ACTIVITY_OK  â”‚   â”‚   â”‚ â† Validation
           â”‚                â”‚    â”‚  â”‚ 3    â”‚ chat-1  â”‚ ACTIVITY_OK  â”‚   â”‚   â”‚ â† LLM gen
           â”‚                â”‚    â”‚  â”‚ 4    â”‚ chat-1  â”‚ ACTIVITY_OK  â”‚   â”‚   â”‚ â† Chunk 0
           â”‚                â”‚    â”‚  â”‚ 5    â”‚ chat-1  â”‚ ACTIVITY_OK  â”‚   â”‚   â”‚ â† Chunk 1
           â”‚                â”‚    â”‚  â”‚ ...  â”‚ ...     â”‚ ...          â”‚   â”‚   â”‚
           â”‚                â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
           â”‚                â”‚    â”‚                                       â”‚   â”‚
           â”‚                â”‚    â”‚  â­ EVERY activity = CHECKPOINT      â”‚   â”‚
           â”‚                â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
           â”‚                â”‚                                                â”‚
           â”‚                â”‚ HTTP (Port 8080)                               â”‚
           â”‚                â–¼                                                â”‚
           â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
           â”‚    â”‚       TEMPORAL UI                        â”‚                â”‚
           â”‚    â”‚  (Container: Port 8080)                  â”‚                â”‚
           â”‚    â”‚                                          â”‚                â”‚
           â”‚    â”‚  Web interface showing:                  â”‚                â”‚
           â”‚    â”‚  â€¢ All workflows                         â”‚                â”‚
           â”‚    â”‚  â€¢ Execution timeline                    â”‚                â”‚
           â”‚    â”‚  â€¢ Event history                         â”‚                â”‚
           â”‚    â”‚  â€¢ Input/Output of each activity         â”‚                â”‚
           â”‚    â”‚  â€¢ Retry attempts                        â”‚                â”‚
           â”‚    â”‚  â€¢ Stack traces on errors                â”‚                â”‚
           â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
           â”‚                                                                 â”‚
           â”‚ gRPC Task Queue: "chat-queue"                                  â”‚
           â–¼                                                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                         TEMPORAL WORKER                               â”‚     â”‚
â”‚                       (Container: worker)                             â”‚     â”‚
â”‚                                                                       â”‚     â”‚
â”‚  â­ EXECUTES WORKFLOWS & ACTIVITIES                                  â”‚     â”‚
â”‚                                                                       â”‚     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚  â”‚  Worker Process (worker.py)                                â”‚     â”‚     â”‚
â”‚  â”‚                                                             â”‚     â”‚     â”‚
â”‚  â”‚  Polls task queue: "chat-queue"                            â”‚     â”‚     â”‚
â”‚  â”‚  Max concurrent activities: 10                             â”‚     â”‚     â”‚
â”‚  â”‚                                                             â”‚     â”‚     â”‚
â”‚  â”‚  Registered Workflows:                                     â”‚     â”‚     â”‚
â”‚  â”‚  â€¢ ChatStreamingWorkflow                                   â”‚     â”‚     â”‚
â”‚  â”‚  â€¢ BatchChatWorkflow                                       â”‚     â”‚     â”‚
â”‚  â”‚                                                             â”‚     â”‚     â”‚
â”‚  â”‚  Registered Activities:                                    â”‚     â”‚     â”‚
â”‚  â”‚  â€¢ validate_prompt                                         â”‚     â”‚     â”‚
â”‚  â”‚  â€¢ generate_full_text_with_llm  â† â­ Calls OpenAI/Anthrop.â”‚     â”‚     â”‚
â”‚  â”‚  â€¢ save_chunk_to_storage                                   â”‚     â”‚     â”‚
â”‚  â”‚  â€¢ notify_frontend                                         â”‚     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚
â”‚                                                                       â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                        â”‚                                                     â”‚
                        â”‚ API Calls                                           â”‚
                        â–¼                                                     â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
            â”‚   OpenAI API         â”‚                                         â”‚
            â”‚   â€¢ gpt-4o           â”‚                                         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
                        â”‚                                                     â”‚
                        â–¼                                                     â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
            â”‚  Anthropic API       â”‚                                         â”‚
            â”‚  â€¢ claude-3.5-sonnet â”‚                                         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
                        â”‚                                                     â”‚
                        â”‚                                                     â”‚
                        â–¼                                                     â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
            â”‚  LOCAL FILE SYSTEM                   â”‚                         â”‚
            â”‚  (Docker volume: worker-storage)     â”‚                         â”‚
            â”‚                                      â”‚                         â”‚
            â”‚  /storage/{workflow_id}/             â”‚                         â”‚
            â”‚  â”œâ”€â”€ chunk_0000.json                 â”‚ â† â­ Each chunk saved  â”‚
            â”‚  â”œâ”€â”€ chunk_0001.json                 â”‚                         â”‚
            â”‚  â”œâ”€â”€ chunk_0002.json                 â”‚                         â”‚
            â”‚  â””â”€â”€ ...                              â”‚                         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
                                                                              â”‚
                                        Docker Network: temporal-network â”€â”€â”€â”€â”€â”˜
```

### Flux Workflow DÃ©taillÃ©

#### 1ï¸âƒ£ DÃ©marrage Workflow

```
User: "Write essay about AI"
    â”‚
    â–¼
POST /api/workflows/start
    â”‚
    â”‚ Body: {
    â”‚   "prompt": "Write essay about AI",
    â”‚   "provider": "openai",
    â”‚   "model": "gpt-4o",
    â”‚   "temperature": 0.7
    â”‚ }
    â–¼
FastAPI Backend (Temporal Client)
    â”‚
    â”‚ 1. Generate workflow_id = "chat-abc-123"
    â”‚
    â”‚ 2. await temporal_client.start_workflow(
    â”‚      ChatStreamingWorkflow.run,
    â”‚      args=["Write essay about AI", "openai", "gpt-4o", 0.7],
    â”‚      id="chat-abc-123",
    â”‚      task_queue="chat-queue",
    â”‚      execution_timeout=timedelta(minutes=10)
    â”‚    )
    â”‚
    â–¼
Temporal Server
    â”‚
    â”‚ 3. Create workflow execution in PostgreSQL
    â”‚    INSERT INTO executions VALUES (
    â”‚      "chat-abc-123",
    â”‚      "ChatStreamingWorkflow",
    â”‚      "running",
    â”‚      ...
    â”‚    )
    â”‚
    â”‚ 4. Create initial event
    â”‚    INSERT INTO history_events VALUES (
    â”‚      1,
    â”‚      "chat-abc-123",
    â”‚      "WORKFLOW_STARTED",
    â”‚      {input: ["Write essay about AI", "openai", ...]}
    â”‚    )
    â”‚
    â”‚ 5. Add task to queue "chat-queue"
    â”‚
    â–¼
Temporal Worker
    â”‚
    â”‚ 6. Poll task queue "chat-queue"
    â”‚    â†’ Receive task for "chat-abc-123"
    â”‚
    â”‚ 7. Start executing ChatStreamingWorkflow.run()
    â”‚
    â””â”€â–º (continue to execution flow)
```

#### 2ï¸âƒ£ ExÃ©cution Workflow avec Checkpoints

```
ChatStreamingWorkflow.run()
    â”‚
    â”‚ Ã‰TAPE 1: VALIDATION
    â–¼
execute_activity(validate_prompt)
    â”‚
    â”‚ Activity runs: validate_prompt("Write essay about AI")
    â”‚ â†’ return True
    â–¼
â­ CHECKPOINT 1
    â”‚
    â”‚ Temporal saves to PostgreSQL:
    â”‚ INSERT INTO history_events VALUES (
    â”‚   2,
    â”‚   "chat-abc-123",
    â”‚   "ACTIVITY_SCHEDULED",
    â”‚   {activity: "validate_prompt"}
    â”‚ )
    â”‚ INSERT INTO history_events VALUES (
    â”‚   3,
    â”‚   "chat-abc-123",
    â”‚   "ACTIVITY_COMPLETED",
    â”‚   {result: true}
    â”‚ )
    â”‚
    â”‚ ğŸ’¾ STATE SAVED: Validation completed = âœ“
    â”‚
    â–¼
    â”‚ Ã‰TAPE 2: GÃ‰NÃ‰RATION LLM
    â–¼
execute_activity(generate_full_text_with_llm)
    â”‚
    â”‚ Activity runs:
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â”‚ 1. Call OpenAI API                   â”‚
    â”‚ â”‚    response = await openai_client... â”‚
    â”‚ â”‚                                      â”‚
    â”‚ â”‚ 2. Get full text (stream=False)      â”‚
    â”‚ â”‚    full_text = response.choices[0]...â”‚
    â”‚ â”‚                                      â”‚
    â”‚ â”‚ 3. Return full_text                  â”‚
    â”‚ â”‚    â†’ "AI is artificial intelligence..â”‚
    â”‚ â”‚       [2000 words]                   â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ â±ï¸ Duration: 5-8 seconds
    â”‚ ğŸ’° Cost: $0.02
    â”‚
    â–¼
â­ CHECKPOINT 2 - LE PLUS CRITIQUE !
    â”‚
    â”‚ Temporal saves to PostgreSQL:
    â”‚ INSERT INTO history_events VALUES (
    â”‚   4,
    â”‚   "chat-abc-123",
    â”‚   "ACTIVITY_SCHEDULED",
    â”‚   {activity: "generate_full_text_with_llm"}
    â”‚ )
    â”‚ INSERT INTO history_events VALUES (
    â”‚   5,
    â”‚   "chat-abc-123",
    â”‚   "ACTIVITY_COMPLETED",
    â”‚   {result: "AI is artificial intelligence...[full text]"}
    â”‚ )
    â”‚
    â”‚ ğŸ’¾ STATE SAVED: LLM generation completed = âœ“
    â”‚ ğŸ’¾ FULL TEXT SAVED in event history
    â”‚
    â”‚ âš¡ SI WORKER CRASH MAINTENANT:
    â”‚    â†’ Workflow reprend ICI
    â”‚    â†’ NE RE-GÃ‰NÃˆRE PAS le texte
    â”‚    â†’ Continue directement au chunking
    â”‚    â†’ Ã‰conomie: $0.02 + 8 secondes
    â”‚
    â–¼
    â”‚ Ã‰TAPE 3: CHUNKING
    â”‚
    â”‚ chunks = split_into_chunks(full_text, 50)
    â”‚ â†’ 100 chunks
    â”‚
    â–¼
    â”‚ Ã‰TAPE 4: SAUVEGARDE CHUNKS (LOOP)
    â”‚
FOR chunk_id in range(100):
    â”‚
    â–¼
    execute_activity(save_chunk_to_storage)
        â”‚
        â”‚ Activity runs:
        â”‚ save_chunk_to_storage(
        â”‚   "chat-abc-123",
        â”‚   chunk_id,
        â”‚   chunks[chunk_id],
        â”‚   "openai",
        â”‚   "gpt-4o"
        â”‚ )
        â”‚
        â”‚ â†’ Writes: /storage/chat-abc-123/chunk_0000.json
        â–¼
    â­ CHECKPOINT 3.0
        â”‚
        â”‚ Temporal saves:
        â”‚ INSERT INTO history_events VALUES (
        â”‚   6,
        â”‚   "chat-abc-123",
        â”‚   "ACTIVITY_COMPLETED",
        â”‚   {chunk_id: 0, saved: true}
        â”‚ )
        â”‚
        â”‚ ğŸ’¾ STATE SAVED: Chunk 0 saved = âœ“
        â”‚
        â–¼
    execute_activity(save_chunk_to_storage)
        â”‚
        â”‚ For chunk_id = 1
        â–¼
    â­ CHECKPOINT 3.1
        â”‚
        â”‚ ...
        â”‚
        â–¼
    [Continue for all 100 chunks]
        â”‚
        â”‚ âš¡ SI WORKER CRASH au chunk 47:
        â”‚    â†’ Workflow reprend au chunk 47
        â”‚    â†’ Chunks 0-46 dÃ©jÃ  sauvegardÃ©s
        â”‚    â†’ Continue chunks 47-99
        â”‚    â†’ ZERO perte
        â”‚
        â–¼
    â­ CHECKPOINT 3.99
        â”‚
        â”‚ All chunks saved
        â”‚
        â–¼
WORKFLOW COMPLETED
    â”‚
    â”‚ INSERT INTO history_events VALUES (
    â”‚   106,
    â”‚   "chat-abc-123",
    â”‚   "WORKFLOW_COMPLETED",
    â”‚   {result: {...}}
    â”‚ )
    â”‚
    â”‚ Update execution:
    â”‚ UPDATE executions
    â”‚ SET status = "completed"
    â”‚ WHERE id = "chat-abc-123"
    â”‚
    â–¼
Backend can query final result
```

#### 3ï¸âƒ£ Query Pendant ExÃ©cution

```
Frontend (polling loop)
    â”‚
    â”‚ GET /api/workflows/chat-abc-123/status
    â–¼
FastAPI Backend
    â”‚
    â”‚ handle = client.get_workflow_handle("chat-abc-123")
    â”‚ status = await handle.query(ChatStreamingWorkflow.get_status)
    â–¼
Temporal Server
    â”‚
    â”‚ âš ï¸ Query is NON-BLOCKING
    â”‚ âš ï¸ Reads from workflow MEMORY (not DB)
    â”‚
    â”‚ Returns current state:
    â”‚ {
    â”‚   "workflow_id": "chat-abc-123",
    â”‚   "status": "generating",      â† Current step
    â”‚   "progress": 47,                â† 47%
    â”‚   "chunks_count": 47,            â† 47 chunks saved
    â”‚   "total_chunks": 100            â† Expected total
    â”‚ }
    â–¼
Backend returns to Frontend
    â”‚
    â–¼
Frontend displays:
    â”‚
    â”‚ ğŸ¤– GENERATING
    â”‚ Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘] 47%
    â”‚ Chunks: 47/100
```

#### 4ï¸âƒ£ Crash Recovery - LE SCÃ‰NARIO CLÃ‰

```
Workflow at chunk 47 (47% complete)
    â”‚
    â”‚ INSERT INTO history_events VALUES (
    â”‚   53,
    â”‚   "chat-abc-123",
    â”‚   "ACTIVITY_COMPLETED",
    â”‚   {chunk_id: 47}
    â”‚ )
    â”‚
    â”‚ ğŸ’¾ Checkpoint 3.47 saved
    â”‚
    â–¼
ğŸ’¥ WORKER CRASH !
    â”‚
    â”‚ docker-compose stop worker
    â”‚
    â”‚ Worker process dies
    â”‚ Workflow execution interrupted
    â”‚
    â±ï¸ 30 seconds pass...
    â”‚
    â–¼
ğŸ”„ WORKER RESTART
    â”‚
    â”‚ docker-compose start worker
    â”‚
    â”‚ Worker connects to Temporal Server
    â”‚ Worker polls task queue "chat-queue"
    â”‚
    â–¼
Temporal Server
    â”‚
    â”‚ âš¡ DETECTS incomplete workflow "chat-abc-123"
    â”‚
    â”‚ 1. Query PostgreSQL history_events:
    â”‚    SELECT * FROM history_events
    â”‚    WHERE workflow_id = "chat-abc-123"
    â”‚    ORDER BY id
    â”‚
    â”‚ 2. Reconstruct state:
    â”‚    âœ“ Event 1: WORKFLOW_STARTED
    â”‚    âœ“ Event 3: validate_prompt â†’ completed
    â”‚    âœ“ Event 5: generate_full_text â†’ completed â­
    â”‚    âœ“ Event 6-53: save_chunk 0-47 â†’ completed
    â”‚    âœ— Event 54+: NOT FOUND
    â”‚
    â”‚ 3. Determine resume point:
    â”‚    â†’ Last completed activity: save_chunk(47)
    â”‚    â†’ Next activity: save_chunk(48)
    â”‚
    â”‚ 4. Replay workflow execution:
    â”‚    â€¢ Skip validate_prompt (already done)
    â”‚    â€¢ Skip generate_full_text (already done) â­ NO RE-GENERATION
    â”‚    â€¢ Skip save_chunk 0-47 (already done)
    â”‚    â€¢ Resume at save_chunk(48)
    â”‚
    â–¼
Worker receives replayed workflow
    â”‚
    â”‚ Workflow context restored:
    â”‚ â€¢ self.chunks = [chunk0, chunk1, ..., chunk47]
    â”‚ â€¢ self.progress = 47
    â”‚ â€¢ full_text = "AI is artificial intelligence..." â­ FROM EVENT 5
    â”‚
    â”‚ Continue execution at chunk 48
    â”‚
    â–¼
execute_activity(save_chunk_to_storage)
    â”‚
    â”‚ For chunk_id = 48
    â”‚ â†’ Writes: /storage/chat-abc-123/chunk_0048.json
    â”‚
    â–¼
â­ CHECKPOINT 3.48
    â”‚
    â”‚ ...continue 49, 50, ..., 99
    â”‚
    â–¼
WORKFLOW COMPLETED
    â”‚
    â”‚ âœ… Total time lost: ~5 seconds (reconnection)
    â”‚ âœ… Total cost lost: $0 (no re-generation)
    â”‚ âœ… Chunks 0-47: Preserved
    â”‚ âœ… Chunks 48-99: Generated
    â”‚ âœ… ZERO data loss
```

### Persistance Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TEMPORAL PERSISTANCE LAYERS                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  LAYER 1: PostgreSQL Event Store                         â”‚
â”‚  â”œâ”€ Stores ALL workflow events                           â”‚
â”‚  â”œâ”€ Immutable log                                         â”‚
â”‚  â”œâ”€ Source of truth for recovery                         â”‚
â”‚  â””â”€ â­ Survives ANY crash                                â”‚
â”‚                                                           â”‚
â”‚  LAYER 2: Workflow Memory                                â”‚
â”‚  â”œâ”€ In-worker process memory                             â”‚
â”‚  â”œâ”€ Fast for queries                                     â”‚
â”‚  â”œâ”€ âŒ Lost on worker crash                              â”‚
â”‚  â””â”€ âœ… Reconstructed from Layer 1                        â”‚
â”‚                                                           â”‚
â”‚  LAYER 3: Activity Outputs (Files)                       â”‚
â”‚  â”œâ”€ /storage/{workflow_id}/chunk_*.json                  â”‚
â”‚  â”œâ”€ Actual chunk data                                    â”‚
â”‚  â”œâ”€ â­ Docker volume persists                            â”‚
â”‚  â””â”€ Used by frontend to display                          â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š COMPARAISON ARCHITECTURALE

### ComplexitÃ©

```
MVP (Simple)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontend â”‚â”€â”€â”€â”€â”€â–¶â”‚Backend  â”‚â”€â”€â”€â”€â”€â–¶â”‚  Files  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    2 containers
    ~450 lines of code
    â­ Setup: 2 minutes

Redis (Medium)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontend â”‚â”€â”€â”€â”€â”€â–¶â”‚Backend  â”‚â”€â”€â”€â”€â”€â–¶â”‚  Redis  â”‚      â”‚PostgreSQLâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚                  â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    4 containers
    ~900 lines of code
    â­ Setup: 3 minutes

Temporal (Complex)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontend â”‚â”€â”€â”€â”€â”€â–¶â”‚Backend  â”‚â—€â”€â”€â”€â”€â–¶â”‚Temporal â”‚â”€â”€â”€â”€â”€â–¶â”‚PostgreSQLâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ Client  â”‚      â”‚ Server  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚ Worker  â”‚â”€â”€â”€â”€â”€â–¶â”‚  Files   â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚Temp. UI â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    6 containers
    ~1100 lines of code
    â­ Setup: 5 minutes
```

### Scaling Horizontal

```
MVP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontend â”‚â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontend â”‚â”€â”€â”€â”€â”€â–¶â”‚Backend  â”‚  âŒ Cannot scale backend
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     (files on single disk)
                      â”‚
                      â–¼
                 Local Files

Redis
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontend â”‚â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚Frontend â”‚â”€â”€â”€â”¼â”€â”€â”€â”€â”€â–¶â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚      â”‚Backend  â”‚â”€â”€â”€â”€â”€â–¶â”‚  Redis  â”‚      â”‚PostgreSQLâ”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚Frontend â”‚â”€â”€â”€â”˜      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â–²                 â–²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚Backend  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     Load            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    Balancer         âœ… Can scale backends
                     âœ… Shared Redis + PostgreSQL

Temporal
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Frontend â”‚â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚Frontend â”‚â”€â”€â”€â”¼â”€â”€â”€â”€â”€â–¶â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚      â”‚Backend  â”‚â—€â”€â”€â”€â”€â–¶â”‚Temporal â”‚â”€â”€â”€â”€â”€â–¶â”‚PostgreSQLâ”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚      â”‚ Client  â”‚      â”‚ Server  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚Frontend â”‚â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
     Load            â”‚Backend  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    Balancer         â”‚ Client  â”‚           â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                                           â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ Worker  â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ Worker  â”‚  âœ… Scale workers
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     independently
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚ Worker  â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CoÃ»t Mensuel (Production)

```
MVP
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component  â”‚   Cost   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Compute    â”‚ $20-50   â”‚
â”‚ Storage    â”‚ $5-10    â”‚
â”‚ Network    â”‚ $5-10    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL      â”‚ $30-70   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Redis
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component  â”‚   Cost   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Compute    â”‚ $100-200 â”‚
â”‚ PostgreSQL â”‚ $100-200 â”‚
â”‚ Redis      â”‚ $200-400 â”‚
â”‚ Storage    â”‚ $20-50   â”‚
â”‚ Network    â”‚ $20-50   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL      â”‚ $440-900 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Temporal
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component  â”‚   Cost    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Compute    â”‚ $200-400  â”‚
â”‚ PostgreSQL â”‚ $100-200  â”‚
â”‚ Temporal   â”‚ $500-800  â”‚ â† Temporal Cloud
â”‚ Workers    â”‚ $100-300  â”‚
â”‚ Storage    â”‚ $50-100   â”‚
â”‚ Network    â”‚ $50-100   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL      â”‚ $1000-1900â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Guarantees (Garanties)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Garantie                â”‚ MVP â”‚ Redis â”‚ Temporal â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Survive F5 (refresh)    â”‚ âš ï¸  â”‚  âœ…   â”‚   âœ…     â”‚
â”‚ Survive backend crash   â”‚ âŒ  â”‚  âš ï¸  â”‚   âœ…     â”‚
â”‚ Survive worker crash    â”‚ N/A â”‚  N/A  â”‚   âœ…     â”‚
â”‚ Zero data loss          â”‚ âŒ  â”‚  âš ï¸  â”‚   âœ…     â”‚
â”‚ Avoid re-generation     â”‚ âŒ  â”‚  âŒ   â”‚   âœ…     â”‚
â”‚ Event history           â”‚ âŒ  â”‚  âš ï¸  â”‚   âœ…     â”‚
â”‚ Monitoring UI           â”‚ âŒ  â”‚  âŒ   â”‚   âœ…     â”‚
â”‚ Retry automatique       â”‚ âŒ  â”‚  âŒ   â”‚   âœ…     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ RECOMMANDATION PAR CAS D'USAGE

### Choisir MVP si:
```
âœ… Dev/Test uniquement
âœ… Prototype rapide
âœ… Budget: $0-100/mois
âœ… Users: 1-10
âœ… Crash = acceptable
```

### Choisir Redis si:
```
âœ… Production PME
âœ… Besoin cache (Ã©conomie)
âœ… Budget: $400-900/mois
âœ… Users: 100-10k
âœ… Crash rare = acceptable
âœ… Pas de tÃ¢ches critiques
```

### Choisir Temporal si:
```
âœ… Production enterprise
âœ… TÃ¢ches critiques (NE PEUVENT PAS Ã©chouer)
âœ… TÃ¢ches longues (>5 min)
âœ… Budget: $1000-2000/mois
âœ… Users: 10k+
âœ… Zero downtime requis
âœ… ObservabilitÃ© complÃ¨te
âœ… Crash recovery obligatoire
```

---

## ğŸ“š RESSOURCES

- MVP Code: `/mnt/user-data/outputs/chatbot-3solutions-complete/solution3-mvp/`
- Redis Code: `/mnt/user-data/outputs/chatbot-3solutions-complete/solution1-redis/`
- Temporal Code: `/mnt/user-data/outputs/chatbot-3solutions-complete/solution2-temporal/`
- Package complet: `/mnt/user-data/outputs/chatbot-3solutions-COMPLETE.zip`

